The following example was take from:
https://linuxgazette.net/151/misc/melinte/
https://linuxgazette.net/151/melinte.html

Monitoring Function Calls
By Aurelian Melinte

To compile this code you will need the binutils package. It can be obtained from the FSF site. 
This code has been tested with version 2.18 of the binutils, if using later versions, it might require modifications.

Do unpack the binutils archive, configure it and make it.
 Do not install it. Then modify the BINUTILS_SOURCE variable in the Makefile to point to the binutils folder.

Now you can compile the code. 


I changed the above example to support output that can be used as input for plantuml.jar
See:
http://plantuml.com/sequence-diagram

See files:
demo.txt
demo.png

To build:
run:
make

To run the trace program:
set:
export CTRACE_PROGRAM=./cppSimpleTraced

run:
LD_PRELOAD=./libctrace.so ./cppSimpleTraced

